---
title: "Stat 400 Project"
authors: "Nathan Hemenway, Mark Hinds, Ian Hall"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)

incubation_time <- rgamma(5, 6, (2/3))
crucial_distance <- rexp(5, 1/8)

#create starting positions and state function
starting_vals <- function(num_subjects, I_0, x_dim, y_dim){
  
  #Infect I_0 many starting subjects
  subjects <- rep('S', num_subjects)
  infect <- sample(x = 1:num_subjects, size=I_0, replace=FALSE)
  subjects[infect] <- 'I'
  
  #Storage for x, y starting positions for the subjects
  start_x <- runif(n=num_subjects, min=0, max=x_dim)
  start_y <- runif(n=num_subjects, min=0, max=y_dim)
  
  #Put into a data frame
  df <- as.data.frame(cbind(as.numeric(start_x), as.numeric(start_y), subjects))
  colnames(df)[1] <- 'x'
  colnames(df)[2] <- 'y'
  return(df)
}

#Random step length function
get_step_length <- function(df, x_dim, y_dim){
  step_lengths <- rnorm(n=nrow(df), mean=min(x_dim, y_dim)/4, sd=min(x_dim, y_dim)/12)
  return(step_lengths)
}

#Random step direction function
get_step_direction <- function(length_vec){
  direction <- runif(n=length(length_vec), min=0, max=2*pi)
}

#Get delta_x, delta_y
get_delts <- function(length_vec, direc_vec){
  delta_x <- length_vec * cos(direc_vec)
  delta_y <- length_vec * sin(direc_vec)
  return(cbind(delta_x, delta_y))
}

#Function for getting updated coordinates
update_coords <- function(og_df, delta_df){
  new_mx <- matrix(data=NA, nrow=nrow(og_df), ncol=2)
  new_df <- data.frame(new_mx)
  new_df[,1] <- as.numeric(og_df[,'x']) + delta_df[,'delta_x']
  new_df[,2] <- as.numeric(og_df[,'y']) + delta_df[,'delta_y']
  colnames(new_df) <- c('x', 'y')
  return(new_df)
}

#Function for deciding if infections occured
infection_status <- function(state){
  
  current_infected <- state[state[,'subjects']=='I',]
  current_suceptable <- state[state[,'subjects']=='S',]
  current_removed <- state[state[,'subjects']=='R',]
  
  #Check to see which suceptable subjects get infected
  crucial_distance <- rexp(n=nrow(coords), 1/8)
  
  #For loop
}

#simulation function
simulator <- function(days, num_subjects, x_dim, y_dim, I_0){
  initial_data <- starting_vals(num_subjects = num_subjects, x_dim=x_dim, y_dim=y_dim, I_0=I_0)
  
  for(i in 1:days){
    
  }
  
  
}

#Testing
df <- starting_vals(100, 2, 10, 10)
len <- get_step_length(df, 10, 10)
dir <- get_step_direction(len)
delts <- get_delts(len, dir)
newdf <- update_coords(df, delts)

#S,I,R data
suceptable = function(){
  
}

recovered = function(){
  
}

infected = function(){
  
}

#reported monte carlo summary data
qd = c(0,25,50,75)
pos = c(99.3,99.2,98.7,92.7)
dncpv = c(69,53,46,33)
dncpt = c(26,32,43,42)
r0 = c(1.8,1.73,1.8,1.63)
mcsum = cbind(qd,pos,dncpv,dncpt,r0)
colnames(mcsum,c("Quarantine degree [%]",	"Percentage of size %",	"DNC peak value [cases]",	"DNC peaking time [days]",	"R0"))
```